@page "/"
@using Telerik.ReportViewer.Blazor
@using DevCraftAspire.Web.Clients
@inject ReportsApiClient ReportsApi

@* Important: prerender the ReportViewer *@
@rendermode InteractiveServer



@* Important: Viewer's resources are loaded in App.razor *@
<ReportViewer @ref="ReportViewer1"
              ViewerId="rv1"
              ServiceUrl="@ApiServiceUrl"
              ReportSource="@MyReportSource"
              ScaleMode="@(ScaleMode.Specific)"
              Scale="1.0" />

@code {
#if DEBUG
    // Dev environment hack
    private string ApiServiceUrl { get; } = "https://localhost:7443/reports";
#elif RELEASE
    // Production hack uses https://apiservice.purpledune-16458cf6.eastus2.azurecontainerapps.io
    private string ApiServiceUrl { get; } = $"{Environment.GetEnvironmentVariable("services__apiservice__https__0")}/reports";
#endif

    private ReportViewer? ReportViewer1 { get; set; }
    private ReportSourceOptions MyReportSource { get; set; } = new() { Report = "Barcodes Report.trdp" };

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
    }
}